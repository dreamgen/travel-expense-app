# 🏖️ 員工旅遊費用申請 APP

一個專為員工旅遊設計的費用申請 PWA (Progressive Web App)，讓員工在旅遊途中就能輕鬆收集單據、記錄費用，並自動產生 Excel 申請單！

## ✨ 主要功能

### 📸 快速記錄費用
- **拍照上傳單據**：直接用手機相機拍攝收據
- **多幣別支援**：支援 TWD、USD、JPY、EUR、CNY 等常用幣別
- **自動匯率計算**：即時轉換為台幣金額
- **五大費用分類**：
  - 🧾 代收轉付收據
  - 🏨 住宿費
  - 🚗 交通費
  - 🍽️ 餐費
  - 📌 其他費用

### 👥 員工管理
- 新增參與旅遊的員工資料
- 設定到職日期自動計算補助比例
- 支援選擇是否申請補助

### 📊 自動統計計算
- 即時顯示單據費用合計
- 自動計算總申請金額（依補助比例）
- 顯示單據數量統計

### 📄 一鍵匯出 Excel
- 完全依照原申請單格式產生
- 自動填入所有費用明細
- 計算補助比例和金額
- 產生標準格式的申請單

## 🚀 使用方式

### 安裝

1. 下載所有檔案：
   - `travel-expense-app.html`
   - `app.js`

2. 將兩個檔案放在同一個資料夾

3. 用瀏覽器打開 `travel-expense-app.html`

### 部署到網路（選配）

可以部署到以下免費平台：
- GitHub Pages
- Netlify
- Vercel
- Firebase Hosting

部署後可以加入手機主畫面，像 APP 一樣使用！

## 📱 使用流程

### 第一步：設定旅遊資訊

1. 點擊底部「⚙️ 設定」分頁
2. 填寫：
   - 旅遊地點（例如：日本東京）
   - 出發日期和結束日期
   - 補助額度（每人，預設 10000）
   - 匯款方式（統一匯款/分開匯款）
   - 補助方式（實支實付/定額補助）
3. 點擊「💾 儲存設定」

### 第二步：新增員工資料

1. 在設定頁面找到「👥 員工名單管理」
2. 點擊「＋ 新增員工」
3. 填寫：
   - 員工姓名
   - 申請補助（是/否）
   - 到職日期（或選擇「滿一年」）
4. 點擊「✓ 新增」

### 第三步：旅遊中記錄費用

1. 回到「🏠 首頁」分頁
2. 點擊右下角「＋」浮動按鈕
3. 填寫費用資訊：
   - 費用類別（住宿、交通、餐費等）
   - 日期
   - 說明（例如：飯店住宿）
   - 幣別和匯率
   - 金額
4. 點擊「📸 拍照上傳單據」拍攝收據
5. 點擊「✓ 新增」儲存

### 第四步：匯出 Excel 申請單

1. 回到「⚙️ 設定」分頁
2. 找到「📥 匯出申請單」區塊
3. 點擊「📄 產生 Excel 申請單」
4. 自動下載產生的 Excel 檔案

## 💡 使用技巧

### 快速記帳
- 旅遊時隨時打開 APP 記錄
- 拍照留存單據避免遺失
- 每天結束前檢查當日費用

### 幣別設定
- 常用匯率已預設
- 可手動調整實際匯率
- 台幣（TWD）匯率固定為 1

### 資料安全
- 所有資料儲存在手機本地
- 不會上傳到雲端
- 可隨時清除瀏覽器資料重置

### 多人使用
- 每個人使用各自的手機記錄
- 最後由一人匯總所有費用
- 或各自匯出再合併

## 🎨 特色功能

### 📅 依日期分組
費用自動按日期分組顯示，一目了然！

### 🏷️ 彩色分類標籤
不同費用類別使用不同顏色區分：
- 🔵 代收轉付（藍色）
- 🟣 住宿費（紫色）
- 🟢 交通費（綠色）
- 🟠 餐費（橘色）
- ⚫ 其他費用（灰色）

### 📊 即時統計
首頁卡片即時顯示：
- 單據費用合計
- 總申請金額
- 單據數量

### 🎯 自動計算補助
根據到職日期自動計算補助比例：
- 滿一年：100% 補助
- 未滿一年：依比例計算
- 上限：每人 10,000 元

## 🔧 進階功能

### 資料匯出格式

產生的 Excel 檔案完全符合原申請單格式，包含：

1. **標題區**
   - 員工自助旅遊費用申請單

2. **補助資訊區**
   - 匯款方式
   - 出發/結束日期
   - 補助額度和方式

3. **員工清單**
   - 姓名、申請狀態
   - 到職日期、補助比例
   - 補助金額、匯款金額

4. **費用明細**
   - 按類別分類
   - 日期、說明
   - 幣別、金額、匯率
   - 台幣金額

5. **統計資訊**
   - 單據費用合計
   - 總申請金額
   - 付款總金額

### 本地儲存

使用瀏覽器 LocalStorage 儲存資料：
- 自動儲存所有變更
- 關閉 APP 後資料保留
- 可跨裝置（需手動匯出匯入）

## 📱 手機使用建議

### iOS (iPhone)
1. 用 Safari 開啟 APP
2. 點擊分享按鈕
3. 選擇「加入主畫面」
4. 完成！可以像一般 APP 使用

### Android
1. 用 Chrome 開啟 APP
2. 點擊選單（右上角三個點）
3. 選擇「安裝應用程式」或「加入主畫面」
4. 完成！

## 🛠️ 技術架構

- **前端框架**：原生 JavaScript + Tailwind CSS
- **Excel 處理**：SheetJS (xlsx.js)
- **資料儲存**：LocalStorage API
- **圖片處理**：FileReader API
- **響應式設計**：Mobile-First 設計

## 📋 系統需求

- 現代瀏覽器（Chrome、Safari、Firefox、Edge）
- 支援 JavaScript
- 支援相機功能（拍照上傳單據）

## 🎯 使用場景

1. **公司員工旅遊**
   - 多人一起出遊
   - 各自記錄費用
   - 統一申請補助

2. **部門團建活動**
   - 活動期間記帳
   - 回來後快速報銷

3. **獎勵旅遊**
   - 享受旅程同時
   - 輕鬆收集單據

## 💼 適用對象

- 公司員工
- HR 人資部門
- 財務會計
- 活動承辦人員

## ⚠️ 注意事項

1. **單據保存**：拍照後建議保留紙本單據
2. **定期備份**：重要資料建議定期匯出
3. **瀏覽器限制**：清除瀏覽器資料會刪除所有記錄
4. **檔案大小**：單據照片會增加儲存空間

## 🆘 常見問題

### Q: 資料會遺失嗎？
A: 資料儲存在本地，除非清除瀏覽器資料，否則會一直保留。

### Q: 可以離線使用嗎？
A: 可以！APP 開啟後即使沒網路也能使用，只有首次載入需要網路。

### Q: 可以多人協作嗎？
A: 目前是單機版本，建議各自記錄後匯總，或由專人負責輸入。

### Q: Excel 格式可以自訂嗎？
A: 目前產生標準格式，如需客製化請聯繫開發者。

### Q: 單據照片可以刪除嗎？
A: 刪除費用記錄時會一併刪除照片。

## 📞 技術支援

如有問題或建議，歡迎回饋！

## 📄 授權

此專案供公司內部使用。

---

**版本**：1.0.0  
**最後更新**：2025-01-29  
**開發者**：Claude AI Assistant

🎉 祝您旅途愉快，輕鬆申請！
