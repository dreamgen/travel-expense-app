# 專案發布與更新流程標準 (Standard Deployment Procedure)

本文件說明 `Travel Expense App` 的標準發布流程。為了確保版本可追溯性，我們採用以下版號規則。

## 1. 版本號定義 (Versioning Strategy)

專案採用 `Major.Minor.Patch` 三碼版本號，其中第三碼 (**Patch**) **必須** 與 Google Apps Script (GAS) 的部署版本號 (Deployment Version) 一致。

*   **格式**: `v{Major}.{Minor}.{GAS_Version}`
*   **範例**: 若 GAS 部署版本為 `13`，專案版本可能是 `v2.0.13`。

## 2. 詳細發布步驟 (Step-by-Step Guide)

請依序執行以下步驟進行更新發布：

### Step 1: 推送程式碼至 GAS
在 `gas/` 目錄下執行：
```bash
cd gas
clasp push
```

### Step 2: 建立 GAS 新部署版本
在 `gas/` 目錄下執行部署指令，並加上描述：
```bash
clasp deploy --description "描述本次更新內容"
```
**注意**: 此步驟執行後，終端機會回傳一個版本號（例如 `Created version 13`）以及一組新的 Web App URL。
*   **記下版本號**: 例如 `13`
*   **記下 Deployment ID / URL**: 例如 `.../exec`

### Step 3: 更新前端設定檔
回到專案根目錄，根據 Step 2 取得的資訊更新以下檔案：

1.  **更新 `config.json`**:
    *   `version`: 修改第三碼為 GAS 版本號 (例如 `2.0.13`)。
    *   `gas_webapp_url`: 更新為 Step 2 產生的新 URL。
    *   `update_message`: 填寫本次更新對使用者的提示訊息。

    ```json
    {
      "version": "2.0.13",  <-- 修改這裡
      "gas_webapp_url": "https://script.google.com/.../exec", <-- 修改這裡
      "update_message": "更新說明..."
    }
    ```

2.  **更新 `app.js`**:
    *   找到 `DEFAULT_API_URL` 常數，更新為 Step 2 的新 URL。

    ```javascript
    const DEFAULT_API_URL = 'https://script.google.com/.../exec'; <-- 修改這裡
    ```

### Step 4: 提交變更至 GitHub
完成設定檔更新後，將所有變更（含文件、程式碼、設定檔）提交至 Git。

```bash
git add .
git commit -m "chore: release v2.0.13 (GAS v13)"
git push
```

---

## 自動化建議 (Future Optimization)
未來可考慮整合 `npm run deploy` 腳本，自動執行上述 `clasp deploy` 並透過 script 解析輸出自動更新 `config.json`，以減少人工錯誤。
